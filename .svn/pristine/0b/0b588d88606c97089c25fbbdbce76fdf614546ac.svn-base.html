<html>
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="cache-control" content="max-age=0" />
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="expires" content="0" />
		<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
		<meta http-equiv="pragma" content="no-cache" />

		<script type="text/javascript" src="../js/jquery-1.10.2.js"></script>
		<script type="text/javascript" src="../js/jquery-ui.js"></script>
		<script type="text/javascript" src="../js/purl.js"></script>
		<script type="text/javascript" src="../js/css_browser_selector.js"></script>

		<link rel="stylesheet" type="text/css" href="../css/jquery-ui.css" />


<style type="text/css">

body {

	background: lightslategray;
}

#notDefinedMod {

	font-size: 0.9em;
	position: absolute;
}

.btn{
	font-size: 0.8em;
}

</style>

<script type="text/javascript">
	
	var div = null;
	
	$(document).ready(function() {
		
		div = $("#notDefinedMod");
		
		$.getJSON("../restricted/rest/abm/notdefinedmodality")
		.done( function(data) {
			
			if(data && data.length>0) {
				
			$.each(data, function(index, mod) {
				
				div.append('<span id="spn'+mod.replace(/\\/g, '_')+'">' + mod + '</span>');
				div.append('&nbsp;&nbsp;<button id="'+mod.replace(/\\/g, '_')+'" class="btn"></button>');
				div.append("<br><br>");
			});
			
			$('.btn').button({ icons: { primary: 'ui-icon-circle-plus' },
							   label: 'Dar de Alta'})
						.on('click', function(){createMod(this.id)});
			}
			else div.append('no se encontraron modalidades');
		})
		.fail( function() {alert('error');} );
		
			var margen = ( $('body').width() - $("#notDefinedMod").width() ) / 3 ;
			$("#notDefinedMod").css('margin-left', margen + 'px');
		
	});
	
	function createMod(name) {
		
		var dto = {
			nombre : name.replace(/_/g, '\\')
		};
		
		$.ajax({
  	  		type: "POST",
  	  		url: '../restricted/rest/abm/newmodality',
  	  		data: dto,
  	  		success: function() { alert('se ha dado de alta la modalidad ' + name.replace(/_/g, '\\'));
  	  							   		$('#'+name).remove(); $('#spn' + name).remove();	},
			error: function() { alert('Ocurrió un error al momento de dar de alta la modalidad'); }
  		});
	}

</script>

</head>

<body>

	<h5>La siguiente lista muestra las modalidades que aún no se han dado de alta.</h5>
		
	<br>	
		
	<div id="notDefinedMod"></div>

</body>

</html>