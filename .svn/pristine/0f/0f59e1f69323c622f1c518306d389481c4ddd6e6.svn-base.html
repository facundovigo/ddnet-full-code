<!DOCTYPE html>
<html>
<head>
<title>Preferencias de usuario</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />

<link rel="stylesheet" type="text/css" href="../css/jquery-ui-1.10.4.css" />
<link rel="stylesheet" type="text/css" href="../css/layout-default.css" />
<link rel="stylesheet" type="text/css" href="../css/main.css" />

<script type="text/javascript" src="../js/jquery-1.10.2.js"></script>
<script type="text/javascript" src="../js/jquery-ui-1.10.4.js"></script>
<script type="text/javascript" src="../js/jquery.layout-1.3.0.js"></script>
<script type="text/javascript" src="../js/jquery.validate.js"></script>
<script type="text/javascript" src="../js/jquery.blockUI.js"></script>
<script type="text/javascript" src="../js/purl.js"></script>

<style type="text/css">

	#listaMedicos {
		font-size: 9pt;
	}
	span {
		cursor: pointer;
		font-weight: bold;
	}

</style>

<script type="text/javascript">
	
	var old;
	
	$(document).ready(function(){
		
		var aux = window.parent.$("#lblGuardia").text();
		old = aux.substring(aux.indexOf('(') + 1, aux.indexOf(')'));
		
		$.getJSON('rest/medicos')
		  .done(function(result) {
		    	
			  	if (result && result.length > 0) {
			    	$.each(result, function(index, dr) {
			    		$('#listaMedicos').append('<span id="'+dr.name+'" onclick="setMG(this);">Dr. ' + dr.ulname + ' (' + dr.name + ')</span><br><br>');
			        });					    	
		    	}
		  });
		
		$('#listaMedicos').css('padding-left', $('body').width()/3);
	});
	
	function setMG(elem){
		
		var span = $(elem);
		$.post('rest/medicos/deGuardia/'+ old +'/'+span.attr('id'))
		window.parent.$("#lblGuardia").text('DE GUARDIA: ' + span.text());
		window.parent.$('#dynamicModalDialogIframe').attr('src', 'about:blank');
		window.parent.$("#dynamicModalDialog").dialog("close");
	}

</script>

</head>
<body>

	<h6>Haga click en el nombre del médico que esté de guardia en este momento</h6>
	
	<div id="listaMedicos">
	
	
	
	</div>
	
</body>
</html>