<!DOCTYPE html>
<html>
<head>
<title>Log de Trazabilidad</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />

<link rel="stylesheet" type="text/css" href="../css/jquery-ui.css" />
<link rel="stylesheet" type="text/css" href="../css/layout-default.css" />
<link rel="stylesheet" type="text/css" href="../css/main.css" />
<link rel="stylesheet" type="text/css" href="../css/jquery.dataTables.css">
<link rel="stylesheet" type="text/css" href="../css/study-log.css" />

<script type="text/javascript" src="../js/jquery-1.10.2.js"></script>
<script type="text/javascript" src="../js/jquery-ui-1.10.4.js"></script>
<script type="text/javascript" src="../js/jquery.layout-1.3.0.js"></script>
<script type="text/javascript" src="../js/jquery.dataTables.js"></script>
<script type="text/javascript" src="../js/jquery.validate.js"></script>
<script type="text/javascript" src="../js/jquery.blockUI.js"></script>
<script type="text/javascript" src="../js/purl.js"></script>

<script type="text/javascript">
		
			var studyID = null;
			
			$(document).ready(function() {
			
				studyID = $.url().param('s');
				
				var columns = [
         						{ "title": "FECHA", "data": "date", "defaultContent": "", 
         							"class": "left", "width": "20%" },
         						{ "title": "USUARIO", "data": "user", "defaultContent": "", 
         							"class": "left", "width": "20%" },
         						{ "title": "TIEMPO", "data": "time", "defaultContent": "", 
         							"class": "left", "width": "20%" },
         						{ "title": "ACCIÓN", "data": "action", "defaultContent": "", 
         							"class": "left", "width": "20%" },
         						{ "title": "PARÁMETROS", "data": "param", "defaultContent": "", 
         							"class": "left", "width": "20%" }
         					  ];
				var columnDefs = [];				

				$('#study-log-table').dataTable({
					"data": [],
					"lengthMenu": [ 5, 10, 15, 20, 25, 30, 50, 75, 100 ],
					"lengthChange": false,
					"pageLength": 10,
					"dom": 'rt<"clear">p',
					"pagingType": "full_numbers",
					"columns": columns,					
					"columnDefs": columnDefs,					
					"language": {
			            "lengthMenu": "Mostrar _MENU_ datos por página",
			            "zeroRecords": "No se encontró información para mostrar con los criterios especificados.",
			            "info": "Mostrando página _PAGE_ de _PAGES_",
			            "infoEmpty": "Sin información para mostrar",
			            "infoFiltered": "(filtrados de un total de _MAX_ datos)",
					    "emptyTable":     "Sin información para mostrar",
					    "infoPostFix":    "",
					    "thousands":      ".",
					    "loadingRecords": "Cargando...",
					    "processing":     "Procesando...",
					    "search":         "Buscar:",
					    "paginate": {
					        "first":      "Primera",
					        "last":       "Última",
					        "next":       "Siguiente",
					        "previous":   "Anterior"
					    },
					    "aria": {
					        "sortAscending":  ": Click para ordenar ascendentemente",
					        "sortDescending": ": Click para ordenar descendentemente"
					    }
					},
					"createdRow": function ( row, data, index ) {
			            
			                $('td', row).css('background' , 'white');
			                $('td', row).css('border-left' , 'solid 1px black');
			                $('td', row).css('border-right' , 'solid 1px black');
			            
			        }
				});
			
				
				$.getJSON('rest/studies/' + studyID + '/study-log')
				.done(function(data) {
					
					var dt = $('#study-log-table').dataTable();
					dt.fnClearTable();
				  	if (data && data.length > 0) dt.fnAddData(data);
				})
				.fail(function(){	alert("Ocurrió un error al cargar el LOG"); 
									window.parent.$("#dynamicModalDialogIframe").attr('src', 'about:blank');
									window.parent.$("#dynamicModalDialog").dialog("close");});
			});
		
		</script>
</head>
<body>

	<div class="study-log">
		<table id="study-log-table" class="display"></table>
	</div>

</body>
</html>