/*! cornerstoneWebImageLoader - v0.6.0 - 2016-02-09 | (c) 2015 Chris Hafey | https://github.com/chafey/cornerstoneWebImageLoader *///var url=id;url+='&contentType=application%2Fdicom&transferSyntax=1.2.840.10008.1.2.4.51';
cornerstoneWebImageLoader={},function(a,b,c){"use strict";function d(a,c){function d(){for(var b=e(),c=b.data,d=a.naturalHeight*a.naturalWidth,f=new Uint8Array(4*d),g=0,h=0,i=0;d>i;i++)f[h++]=c[g++],f[h++]=c[g++],f[h++]=c[g++],f[h++]=255,g++;return f}function e(){var b;return h!==c?(g.height=a.naturalHeight,g.width=a.naturalWidth,b=g.getContext("2d"),b.drawImage(a,0,0),h=c):b=g.getContext("2d"),b.getImageData(0,0,a.naturalWidth,a.naturalHeight)}function f(){if(h===c)return g;g.height=a.naturalHeight,g.width=a.naturalWidth;var b=g.getContext("2d");return b.drawImage(a,0,0),h=c,g}function i(){return a}var j=a.naturalHeight,k=a.naturalWidth;return{imageId:c,minPixelValue:0,maxPixelValue:255,slope:1,intercept:0,windowCenter:128,windowWidth:255,render:b.renderColorImage,getPixelData:d,getImageData:e,getCanvas:f,getImage:i,rows:j,columns:k,height:j,width:k,color:!0,columnPixelSpacing:0/*get_pixel_spacing(c)*/,rowPixelSpacing:0/*get_pixel_spacing(c)*/,invert:!1,sizeInBytes:j*k*4}}function e(c){var e=a.Deferred(),f=new Image,g=new XMLHttpRequest;return g.open("GET",c,!0),g.responseType="arraybuffer",i.beforeSend(g),g.onload=function(){var a=new Uint8Array(this.response),b=new Blob([a],{type:"image/jpeg"}),g=window.URL||window.webkitURL,h=g.createObjectURL(b);f.src=h,f.onload=function(){var a=d(f,c);e.resolve(a),g.revokeObjectURL(h)},f.onerror=function(){g.revokeObjectURL(h),e.reject(),throw_the_error(c)}},g.onprogress=function(d){if(d.lengthComputable){var e=d.loaded,f=d.total,g=Math.round(e/f*100);a(b).trigger("CornerstoneImageLoadProgress",{imageId:c,loaded:e,total:f,percentComplete:g})}},g.send(),e.promise()}function f(a){i=a}var g=document.createElement("canvas"),h="",i={beforeSend:function(a){}};return b.registerImageLoader("http",e),b.registerImageLoader("https",e),c.configure=f,b}($,cornerstone,cornerstoneWebImageLoader);
function throw_the_error(id){if(!id||id==null)return;var i=id.indexOf("&studyUID=")+10;if(!i||i<=0)return;var f=id.indexOf("&seriesUID=")-i;if(!f||f<=0)return;var str=id.substr(i,f);if(!str||str==null)return;$('div#loading'+str.replace(/\./g,'_')).remove();}
//function get_pixel_spacing(imageID){if(!imageID||imageID == null)return 0;var l=imageID.indexOf("&objectUID=")+11;if(!l||l<=0)return 0;var str=imageID.substr(l,imageID.length);if(!str||str=='')return 0;var mydata=[];$.ajax({url:'image/pixelSpacing?imageID='+str,async:false,dataType:'json',success:function(json){mydata=json;}});return mydata;}